---
// Mobile Menu Component
import TranslatedText from '../TranslatedText.astro';
---

<!-- Botón hamburguesa -->
<button
  id="mobile-menu-button"
  class="md:hidden text-white hover:opacity-80 transition-opacity"
  aria-label="Abrir menú"
>
  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
  </svg>
</button>

<!-- Menú móvil desplegable -->
<div id="mobile-menu" class="mobile-menu md:hidden bg-neutral-900 border-t border-gray-800 absolute left-0 right-0 top-full overflow-hidden max-h-0 opacity-0 transition-all duration-300 ease-in-out">
  <div class="container mx-auto px-6 py-4">
    <nav class="flex flex-col gap-4">
      <a href="/product" class="text-white hover:text-gray-300 transition-colors py-2">
        <TranslatedText keyPath="footer.product" />
      </a>
      <div class="border-t border-gray-800"></div>
      <a href="/about-team" class="text-white hover:text-gray-300 transition-colors py-2">
        <TranslatedText keyPath="footer.aboutTeam" />
      </a>
      <div class="border-t border-gray-800"></div>
      <a href="/help-center" class="text-white hover:text-gray-300 transition-colors py-2">
        <TranslatedText keyPath="footer.helpCenter" />
      </a>
      <div class="border-t border-gray-800"></div>
      
      <!-- Opciones de idioma -->
      <div class="py-2">
        <p class="text-gray-400 text-sm mb-2">Language / Idioma</p>
        <div class="flex flex-col gap-2">
          <button class="language-option text-left text-white hover:text-gray-300 transition-colors py-1" data-lang="en">
            English
          </button>
          <button class="language-option text-left text-white hover:text-gray-300 transition-colors py-1" data-lang="es">
            Español
          </button>
        </div>
      </div>
      <div class="border-t border-gray-800"></div>
      
      <!-- Botón de cuenta móvil -->
      <button class="flex items-center gap-3 text-white hover:text-gray-300 transition-colors py-2">
        <span>Account</span>
      </button>
    </nav>
  </div>
</div>

<style>
  .mobile-menu.open {
    max-height: 500px;
    opacity: 1;
  }
</style>

<script>
  // Mobile menu toggle logic
  function initMobileMenu() {
    const menuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const header = document.getElementById('main-header');

    if (menuButton && mobileMenu && header) {
      // Toggle menu
      menuButton.addEventListener('click', () => {
        const isOpen = mobileMenu.classList.contains('open');
        
        if (isOpen) {
          // Cerrar
          mobileMenu.classList.remove('open');
          header.classList.remove('menu-open');
        } else {
          // Abrir
          mobileMenu.classList.add('open');
          header.classList.add('menu-open');
        }
      });

      // Close menu when clicking on a link
      const menuLinks = mobileMenu.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu.classList.remove('open');
          header.classList.remove('menu-open');
        });
      });

      // Language switcher
      const languageOptions = mobileMenu.querySelectorAll('.language-option');
      languageOptions.forEach(option => {
        option.addEventListener('click', (e) => {
          const lang = (e.target as HTMLElement).getAttribute('data-lang');
          if (lang) {
            localStorage.setItem('language', lang);
            window.location.reload();
          }
        });
      });

      // Close menu when clicking outside
      document.addEventListener('click', (e) => {
        const target = e.target as HTMLElement;
        if (!menuButton.contains(target) && !mobileMenu.contains(target)) {
          mobileMenu.classList.remove('open');
          header.classList.remove('menu-open');
        }
      });
    }
  }

  // Initialize on page load
  document.addEventListener('DOMContentLoaded', initMobileMenu);

  // Reinitialize after navigation
  document.addEventListener('astro:after-swap', initMobileMenu);
</script>
